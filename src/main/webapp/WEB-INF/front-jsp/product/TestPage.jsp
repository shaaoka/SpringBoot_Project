<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
    <!DOCTYPE html>
    <html>

    <head>
        <meta charset="UTF-8">
        <title>Test Page</title>
        <link rel="stylesheet" href="../../../static/back/css/styles.min.css" />
    </head>

    <body>
        <h1 class="mb-3" align="center" style="color: blue;">TEST測試試試是噁瑞</h1>

        <div class="hello">
            <button class="d1">asdasd</button>
            <div class="d2">2ddddddddddddddddd</div>
            <div class="d3">3ddssasdasda</div>
            <div class="d4">4eqweqeqweqw</div>
            <div class="d5">5eeeeee</div>
        </div>

        <!-- 產品陳列範例 
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4" id="product-item">
            <div class="rounded position-relative">
                <div class="product-img">
                    <img src="/images/product/芝麻德國比烤餅.jpg" class="w-100 rounded-top"
                        alt="暫無圖片">
                </div>
                <div class="text-white bg-secondary px-3 py-1 rounded position-absolute"
                    style="top: 10px; left: 10px;">甜點</div>
                <div
                    class="p-4 border border-secondary border-top-0 rounded-bottom">
                    <h5>芝麻德國比烤餅</h5>
                    <p style="height: 100px;">黑白芝麻與酥脆薄餅
                    </p>
                    <div class="d-flex justify-content-between flex-lg-wrap">
                        <p class="text-dark fs-5 fw-bold mb-0">數量: 15</p>
                        <p class="text-dark fs-5 fw-bold mb-0">金額: 120</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4" id="product-item">
            <div class="rounded position-relative">
                <div class="product-img">
                    <img src="/images/product/666.jpg" class="w-100 rounded-top"
                        alt="暫無圖片">
                </div>
                <div class="text-white bg-secondary px-3 py-1 rounded position-absolute"
                    style="top: 10px; left: 10px;">甜點</div>
                <div
                    class="p-4 border border-secondary border-top-0 rounded-bottom">
                    <h5>芝麻德國比烤餅</h5>
                    <p style="height: 100px;">
                        asdasd黑白芝麻與黑白芝麻與黑白芝麻與黑白芝麻與asdasd黑白芝麻與酥脆薄餅</p>
                    <div class="d-flex justify-content-between flex-lg-wrap">
                        <p class="text-dark fs-5 fw-bold mb-0">數量: 15</p>
                        <p class="text-dark fs-5 fw-bold mb-0">金額: 120</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4" id="product-item">
            <div class="rounded position-relative">
                <div class="product-img">
                    <img src="/images/product/2222.jpg" class="w-100 rounded-top"
                        alt="暫無圖片">
                </div>
                <div class="text-white bg-secondary px-3 py-1 rounded position-absolute"
                    style="top: 10px; left: 10px;">甜點</div>
                <div
                    class="p-4 border border-secondary border-top-0 rounded-bottom">
                    <h5>芝麻德國比烤餅</h5>
                    <p style="height: 100px;">
                        aasdssds黑白芝麻與黑白芝麻與黑白芝麻與黑白芝麻與黑白芝麻與sdsdsdsdsddsdsd黑白芝麻與酥脆薄餅
                    </p>
                    <div class="d-flex justify-content-between flex-lg-wrap">
                        <p class="text-dark fs-5 fw-bold mb-0">數量: 15</p>
                        <p class="text-dark fs-5 fw-bold mb-0">金額: 120</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4" id="product-item">
            <div class="rounded position-relative">
                <div class="product-img">
                    <img src="/images/product/2222.jpg" class="w-100 rounded-top"
                        alt="暫無圖片">
                </div>
                <div class="text-white bg-secondary px-3 py-1 rounded position-absolute"
                    style="top: 10px; left: 10px;">甜點</div>
                <div
                    class="p-4 border border-secondary border-top-0 rounded-bottom">
                    <h5>芝麻德國比烤餅</h5>
                    <p style="height: 100px;">
                        aasdssds黑白芝麻與黑白芝麻與黑白芝麻與黑白芝麻與黑白芝麻與sdsdsdsdsddsdsd黑白芝麻與酥脆薄餅
                    </p>
                    <div class="d-flex justify-content-between flex-lg-wrap">
                        <p class="text-dark fs-5 fw-bold mb-0">數量: 15</p>
                        <p class="text-dark fs-5 fw-bold mb-0">金額: 120</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4" id="product-item">
            <div class="rounded position-relative">
                <div class="product-img">
                    <img src="/images/product/2222.jpg" class="w-100 rounded-top"
                        alt="暫無圖片">
                </div>
                <div class="text-white bg-secondary px-3 py-1 rounded position-absolute"
                    style="top: 10px; left: 10px;">甜點</div>
                <div
                    class="p-4 border border-secondary border-top-0 rounded-bottom">
                    <h5>芝麻德國比烤餅</h5>
                    <p style="height: 100px;">
                        aasdssds黑白芝麻與黑白芝麻與黑白芝麻與黑白芝麻與黑白芝麻與sdsdsdsdsddsdsd黑白芝麻與酥脆薄餅
                    </p>
                    <div class="d-flex justify-content-between flex-lg-wrap">
                        <p class="text-dark fs-5 fw-bold mb-0">數量: 15</p>
                        <p class="text-dark fs-5 fw-bold mb-0">金額: 120</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4" id="product-item">
            <div class="rounded position-relative">
                <div class="product-img">
                    <img src="/images/product/2222.jpg" class="w-100 rounded-top"
                        alt="暫無圖片">
                </div>
                <div class="text-white bg-secondary px-3 py-1 rounded position-absolute"
                    style="top: 10px; left: 10px;">甜點</div>
                <div
                    class="p-4 border border-secondary border-top-0 rounded-bottom">
                    <h5>芝麻德國比烤餅</h5>
                    <p style="height: 100px;">
                        aasdssds黑白芝麻與黑白芝麻與黑白芝麻與黑白芝麻與黑白芝麻與sdsdsdsdsddsdsd黑白芝麻與酥脆薄餅
                    </p>
                    <div class="d-flex justify-content-between flex-lg-wrap">
                        <p class="text-dark fs-5 fw-bold mb-0">數量: 15</p>
                        <p class="text-dark fs-5 fw-bold mb-0">金額: 120</p>
                    </div>
                </div>
            </div>
        </div>-->

        <div>
            <button onclick="dis()">消失</button>
        </div>

        <div id="testbody">

        </div>
        <!-- 分页控件 -->
        <div class="container">
            <div class="row">
                <div class="col-auto">
                    <div class="d-flex flex-column align-items-end">
                        <div class="pagination-info m-2">
                            <span id="paginationInfo"></span>
                        </div>
                    </div>
                    <div class="col-auto">
                        <div class="input-group">
                            <input type="number" id="pageNumberInput" class="form-control" placeholder="跳轉頁碼"
                                style="width: 120px;">
                            <div class="input-group-append">
                                <button id="goToPageBtn" class="btn btn-muted m-1">跳轉</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-7"></div>
                <!-- 空白的 col-auto -->
                <div class="col-auto ml-auto">
                    <!-- 要置右邊的 col-auto -->
                    <div class="pagination-container">
                        <ul class="pagination justify-content-end m-3">
                            <li class="page-item" id="firstPage"><a class="page-link" href="#">«</a></li>
                            <li class="page-item" id="prevPage"><a class="page-link" href="#">‹</a></li>
                            <li class="page-item" id="nextPage"><a class="page-link" href="#">›</a></li>
                            <li class="page-item" id="lastPage"><a class="page-link" href="#">»</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>


        <!-- <script src="../../../static/back/libs/jquery/dist/jquery.min.js"></script> -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>





        <script>
            $(document).ready(function () {
                var pageSize = 5; // 顯示的筆數
                var currentPage = 0; // 目前頁碼

                // 发送 AJAX 请求
                function fetchOrders(page) {
                    console.log('page: ' + page);
                    $.ajax({
                        url: 'TestPage2',
                        type: 'GET',
                        dataType: 'json',
                        data: { page: page, size: pageSize }, // 分頁參數
                        success: function (response) { // 請求成功時執行的function
                            // 清空表格内容
                            $('#testbody').empty();
                            // 遍歷返回的數據並將每一行添加到表格中
                            $.each(response.content, function (index, order) {
                                var row = '<div class="array" align="center">' +
                                    '<div>' + order.tname1 + '</div>' +
                                    '<div>' + order.tname2 + '</div>' +
                                    '<div>' + order.tname3 + '</div>' +
                                    '<div>' + order.tname4 + '</div>' +
                                    '<div>' + order.tname5 + '</div>' +
                                    '<div>' + order.tname6 + '</div>' +
                                    '<div>' + order.tstate + '</div>' +
                                    '</div>' + '</br></br>';
                                $('#testbody').append(row);
                            });

                            // 更新分頁狀態
                            updatePagination(response);
                        },
                        error: function (xhr, status, error) { // 请求失敗時執行的function
                            console.error(error);
                        }
                    });
                }

                // 更新分頁狀態和顯示信息
                function updatePagination(response) {
                    var totalPages = response.totalPages;
                    var totalElements = response.totalElements;
                    var currentPageNumber = response.number + 1;

                    console.log(response.first);
                    console.log(response.last);
                    // 更新分頁信息顯示
                    $('#paginationInfo').text('Total Records: ' + totalElements + ', Page: ' + currentPageNumber + ' / ' + totalPages);

                    // 更新分頁按鈕狀態
                    if (response.first) {
                        $('#firstPage, #prevPage').addClass('disabled');
                    } else {
                        $('#firstPage, #prevPage').removeClass('disabled');
                    }
                    if (response.last) {
                        $('#lastPage, #nextPage').addClass('disabled');
                    } else {
                        $('#lastPage, #nextPage').removeClass('disabled');
                    }

                    // 更新页码按钮
                    updatePageButtons(currentPageNumber, totalPages);


                }

                // 上一頁按鈕點擊事件
                $('#prevPage').click(function () {
                    if (!$(this).hasClass('disabled')) {
                        currentPage--;
                        fetchOrders(currentPage);
                    }
                });

                // 下一頁按鈕點擊事件
                $('#nextPage').click(function () {
                    if (!$(this).hasClass('disabled')) {
                        currentPage++;
                        fetchOrders(currentPage);
                    }
                });

                // 第一頁按鈕點擊事件
                $('#firstPage').click(function () {
                    if (!$(this).hasClass('disabled')) {
                        currentPage = 0;
                        fetchOrders(currentPage);
                    }
                });

                // 最后一頁按鈕點擊事件
                $('#lastPage').click(function () {
                    if (!$(this).hasClass('disabled')) {
                        var totalPages = parseInt($('#paginationInfo').text().split('/')[1].trim());
                        currentPage = totalPages - 1;
                        fetchOrders(currentPage);
                    }
                });

                // 更新页码按钮
                function updatePageButtons(currentPageNumber, totalPages) {
                    // 更新页码按钮的显示内容
                    $('#page1 a').text(currentPageNumber > 1 ? currentPageNumber - 1 : 1);
                    $('#page2 a').text(currentPageNumber);
                    $('#page3 a').text(currentPageNumber < totalPages ? currentPageNumber + 1 : totalPages);

                    // 根据需要添加或删除页码按钮
                    if (currentPageNumber === 1) {
                        $('#page1').hide();
                    } else {
                        $('#page1').show();
                    }

                    if (currentPageNumber === totalPages || totalPages === 0) {
                        $('#page3').hide();
                    } else {
                        $('#page3').show();
                    }
                }

                // 新增的页码按钮点击事件
                $('.pagination-container').on('click', '#page1, #page2, #page3', function () {
                    var page = parseInt($(this).text()) - 1;
                    fetchOrders(page);

                    // 更新当前页码
                    currentPage = page;
                });

                $('#goToPageBtn').click(function () {
                    var pageNumber = parseInt($('#pageNumberInput').val());
                    var totalPages = parseInt($('#paginationInfo').text().split('/')[1].trim());

                    // 检查输入的页码是否合法
                    if (pageNumber >= 1 && pageNumber <= totalPages) {
                        var page = pageNumber - 1;
                        fetchOrders(page);
                        currentPage = page;

                        // 移除所有页面项上的 active 类
                        $('.pagination-container .page-item').removeClass('active');

                        // 添加 active 类到指定的页面项
                        $('#page' + pageNumber).addClass('active');
                    } else {
                        // 提示用户输入的页码无效
                        alert('Invalid page number! Please enter a number between 1 and ' + totalPages);
                    }
                });

                // 初始化頁面 獲得第0頁的數據
                fetchOrders(currentPage);
            });

            function dis() {
                $('.d1').prop('disabled', true);
            }

        </script>
    </body>

    </html>